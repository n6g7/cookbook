{
  "rules": {
    "baskets": {
      "$uid": {
        ".read": "auth.uid == $uid && root.child('users/'+auth.uid+'/access').val() == true",
        ".write": "auth.uid == $uid && root.child('users/'+auth.uid+'/access').val() == true",

        "$bid": {
          "archived": {
            ".validate": "newData.isBoolean()"
          },
          "name": {
            ".validate": "newData.isString() && newData.val().length > 0"
          },
          "recipes": {
            "$rid": {
              ".validate": "root.child('recipes/' + $rid).exists() && newData.isNumber()"
            }
          }
        }
      }
    },

    "categories": {
      ".read": "auth != null && root.child('users/'+auth.uid+'/access').val() == true",
      ".write": false,

      "$cid": {
        "name": {
          ".validate": "newData.isString() && newData.val().length > 0"
        }
      }
    },

    "ingredients": {
      ".read": "auth != null && root.child('users/'+auth.uid+'/access').val() == true",
      ".write": false,

      "$iid": {
        "category": {
          ".validate": "root.child('categories/' + newData.val()).exists()"
        },
        "cheese": {
          ".validate": "newData.isBoolean()"
        },
        "meat": {
          ".validate": "newData.isBoolean()"
        },
        "name": {
          ".validate": "newData.isString() && newData.val().length > 0"
        },
        "unit": {
          ".validate": "root.child('units/' + newData.val()).exists()"
        }
      }
    },

    "recipes": {
      ".read": "auth != null && root.child('users/'+auth.uid+'/access').val() == true",

      "$rid": {
        ".write": "auth != null && root.child('users/'+auth.uid+'/access').val() == true",

        "calories": {
          ".validate": "newData.isNumber()"
        },
        "healthScore": {
          ".validate": "newData.isNumber()"
        },
        "image": {
          ".validate": "!newData.exists() || newData.isString()"
        },
        "ingredients": {
          "$iid": {
            ".validate": "root.child('ingredients/' + $iid).exists() && newData.isNumber()"
          }
        },
        "name": {
          ".validate": "newData.isString() && newData.val().length > 0"
        },
        "preparationTime": {
          ".validate": "newData.isNumber()"
        },
        "serves": {
          ".validate": "newData.isNumber()"
        }
      }
    },

    "units": {
      ".read": "auth != null && root.child('users/'+auth.uid+'/access').val() == true",
      ".write": false,

      "$uid": {
        "name": {
          ".validate": "newData.isString() && newData.val().length > 0"
        },
        "symbol": {
          ".validate": "newData.isString() && newData.val().length > 0"
        }
      }
    },

    "users": {
      ".read": false,
      ".write": false,

      "$uid": {
        "access": {
          ".validate": "newData.isBoolean()"
        }
      }
    }
  }
}
